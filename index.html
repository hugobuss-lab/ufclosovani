<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Losování UFC 4 Zápasníků a Zápasů</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
        #fighters, #matchup {
            margin-top: 20px;
            font-size: 20px;
        }
        .fighter-list {
            margin: 10px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }
        .fighter {
            width: 200px;
            padding: 10px;
            margin: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f5f5f5;
        }
    </style>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
</head>
<body>

    <h1>Losování UFC 4 Zápasníků a Zápasů</h1>

    <!-- Uživatel 1 Losování -->
    <h2>Uživatel 1</h2>
    <button id="drawFighterBtn1">Losovat 8 Zápasníků</button>
    <div id="fighters1" class="fighter-list"></div>

    <!-- Uživatel 2 Losování -->
    <h2>Uživatel 2</h2>
    <button id="drawFighterBtn2" style="display:none;">Losovat 8 Zápasníků</button>
    <div id="fighters2" class="fighter-list"></div>

    <!-- Losování zápasů -->
    <button id="drawMatchupBtn" style="display:none;">Losovat Zápasy</button>
    <div id="matchup" style="display:none;"></div>

    <script>
        // Seznam bojovníků (můžeš přidat více bojovníků)
        const allFighters = [
            'Omari Akhmedov', 'Michael Bisping', 'Derek Brunson', 'Jared Canonnier', 
            'Khamzat Chimaev', 'Paulo Costa', 'Nick Diaz', 'Dricus Du Plessis', 
            'Kelvin Gastelum', 'Uriah Hall', 'Jack Hermansson', 'Kevin Holland', 
            'Krzysztof Jotko', 'Lyoto Machida', 'Demian Maia', 'Bo Nickal', 
            'Alex Pereira', 'Luke Rockhold', 'Yoel Romero', 'Thiago Santos', 
            'Anderson Silva', 'Anthony Smith', 'G. St-Pierre', 'Sean Strickland', 
            'Darren Till', 'Marvin Vettori', 'Robert Whittaker'
        ];

        // Seznam pro uchovávání vylosovaných bojovníků
        let user1Fighters = [];
        let user2Fighters = [];
        let remainingFighters = [...allFighters]; // Udržíme seznam pro společné losování

        // Firebase konfigurace
        const firebaseConfig = {
            apiKey: "AIzaSyBchdjFEa0njLG5xpXWhPMJqq4O34gysNg",
            authDomain: "ufclosovani.firebaseapp.com",
            projectId: "ufclosovani",
            storageBucket: "ufclosovani.firebasestorage.app",
            messagingSenderId: "138751202363",
            appId: "1:138751202363:web:71fcefa92e79a90c9fb81e",
            measurementId: "G-Q4MZ39CYVD"
        };

        // Inicializace Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();  // Firestore databáze

        // Funkce pro losování 8 zápasníků pro uživatele
        function drawFighters(user) {
            let selectedFighters = [];
            
            // Vybere 8 zápasníků z dostupných
            for (let i = 0; i < 8; i++) {
                const randomIndex = Math.floor(Math.random() * remainingFighters.length);
                selectedFighters.push(remainingFighters[randomIndex]);
                remainingFighters.splice(randomIndex, 1); // Odstraníme vybraného bojovníka
            }

            // Uložení zápasníků do Firebase
            if (user === 1) {
                user1Fighters = selectedFighters;
                saveFightersToFirebase(1, selectedFighters);
                document.getElementById('fighters1').innerHTML = selectedFighters.map(fighter => `<div class="fighter">${fighter}</div>`).join('');
                document.getElementById('drawFighterBtn2').style.display = 'inline-block'; // Umožní druhému uživateli losování
            } else {
                user2Fighters = selectedFighters;
                saveFightersToFirebase(2, selectedFighters);
                document.getElementById('fighters2').innerHTML = selectedFighters.map(fighter => `<div class="fighter">${fighter}</div>`).join('');
                document.getElementById('drawMatchupBtn').style.display = 'inline-block'; // Umožní losování zápasů
            }
        }

        // Funkce pro uložení vylosovaných zápasníků do Firebase
        function saveFightersToFirebase(user, fighters) {
            const userId = `user${user}`;
            db.collection('fighters').doc(userId).set({
                fighters: fighters
            }).then(() => {
                console.log(`Zápasníci pro uživatele ${user} byli uloženi.`);
            }).catch((error) => {
                console.error("Chyba při ukládání zápasníků: ", error);
            });
        }

        // Sledování zápasníků druhého uživatele v reálném čase
        db.collection('fighters').doc('user2').onSnapshot((doc) => {
            if (doc.exists) {
                const fighters = doc.data().fighters;
                document.getElementById('fighters2').innerHTML = fighters.map(fighter => `<div class="fighter">${fighter}</div>`).join('');
            }
        });

        // Funkce pro losování zápasů mezi 2 uživateli
        function drawMatchups() {
            if (user1Fighters.length !== 8 || user2Fighters.length !== 8) {
                alert("Oba uživatelé musí mít 8 zápasníků, než můžete losovat zápasy!");
                return;
            }

            let matchups = [];
            for (let i = 0; i < 8; i++) {
                matchups.push(`${user1Fighters[i]} vs. ${user2Fighters[i]}`);
            }
            saveMatchupsToFirebase(matchups);
            document.getElementById('matchup').innerHTML = matchups.map(match => `<div>${match}</div>`).join('');
        }

        // Funkce pro uložení zápasů do Firebase
        function saveMatchupsToFirebase(matchups) {
            db.collection('matchups').doc('current').set({
                matchups: matchups
            }).then(() => {
                console.log("Zápasy byly uloženy.");
            }).catch((error) => {
                console.error("Chyba při ukládání zápasů: ", error);
            });
        }

        // Sledování zápasů v reálném čase
        db.collection('matchups').doc('current').onSnapshot((doc) => {
            if (doc.exists) {
                const matchups = doc.data().matchups;
                document.getElementById('matchup').innerHTML = matchups.map(match => `<div>${match}</div>`).join('');
            }
        });

        // Event listeners pro tlačítka
        document.getElementById('drawFighterBtn1').addEventListener('click', function() {
            drawFighters(1);
        });

        document.getElementById('drawFighterBtn2').addEventListener('click', function() {
            drawFighters(2);
        });

        document.getElementById('drawMatchupBtn').addEventListener('click', function() {
            drawMatchups();
        });
    </script>

</body>
</html>
